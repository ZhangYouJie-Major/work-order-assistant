# LangChain 1.0 å‡çº§å¯è¡Œæ€§åˆ†æžæŠ¥å‘Š

## ðŸ“‹ æ‰§è¡Œæ‘˜è¦

**ç»“è®ºï¼šâœ… é«˜åº¦å¯è¡Œï¼Œå‡ ä¹Žé›¶é£Žé™©**

æœ¬é¡¹ç›®**å®žé™…ä¸Šå·²ç»åœ¨è¿è¡Œ LangChain 1.0 ç‰ˆæœ¬**ï¼Œåªéœ€è¦æ›´æ–° `pyproject.toml` é…ç½®æ–‡ä»¶ä½¿å…¶ä¸Žå®žé™…å®‰è£…ç‰ˆæœ¬ä¿æŒä¸€è‡´å³å¯ã€‚ç»è¿‡å…¨é¢åˆ†æžï¼Œé¡¹ç›®ä»£ç ä¸Ž LangChain 1.0 å®Œå…¨å…¼å®¹ï¼Œæ— éœ€ä»»ä½•ä»£ç ä¿®æ”¹ã€‚

---

## ðŸ“Š å½“å‰çŠ¶æ€åˆ†æž

### 1. å®žé™…å®‰è£…ç‰ˆæœ¬ï¼ˆè¿è¡ŒçŽ¯å¢ƒï¼‰

```bash
langchain               1.0.2
langchain-core          1.0.1
langchain-openai        1.0.1
langchain-anthropic     1.0.0
langgraph               1.0.1
langchain-community     0.4.1  # æœªåœ¨ä»£ç ä¸­ä½¿ç”¨
```

### 2. é…ç½®æ–‡ä»¶å£°æ˜Žç‰ˆæœ¬ï¼ˆpyproject.tomlï¼‰

```toml
langchain>=0.3.27
langchain-core>=0.3.0
langchain-community>=0.3.0
langchain-openai>=0.3.33
langchain-anthropic>=0.3.20
langgraph>=0.6.7
```

**çŠ¶æ€ï¼š** é…ç½®æ–‡ä»¶ä¸Žå®žé™…å®‰è£…ç‰ˆæœ¬ä¸ä¸€è‡´ï¼Œå»ºè®®æ›´æ–°é…ç½®æ–‡ä»¶ã€‚

---

## ðŸ” ä»£ç ä½¿ç”¨åˆ†æž

### æ¶‰åŠçš„æ–‡ä»¶å’ŒåŠŸèƒ½

| æ–‡ä»¶ | ä½¿ç”¨çš„ LangChain åŠŸèƒ½ | 1.0 å…¼å®¹æ€§ |
|------|---------------------|-----------|
| `sql_tool.py` | `@tool` è£…é¥°å™¨ | âœ… å®Œå…¨å…¼å®¹ |
| `llm_service.py` | `ChatOpenAI`, `HumanMessage`, `SystemMessage`, `JsonOutputParser` | âœ… å®Œå…¨å…¼å®¹ |
| `mutation_steps_service.py` | `HumanMessage`, `SystemMessage` | âœ… å®Œå…¨å…¼å®¹ |
| `entity_extraction.py` | `HumanMessage`, `SystemMessage` | âœ… å®Œå…¨å…¼å®¹ |
| `work_order_workflow.py` | `StateGraph`, `END` | âœ… å®Œå…¨å…¼å®¹ |
| `state.py` | `TypedDict` çŠ¶æ€å®šä¹‰ | âœ… å®Œå…¨å…¼å®¹ï¼Œç¬¦åˆ 1.0 æœ€ä½³å®žè·µ |

### ä½¿ç”¨çš„æ ¸å¿ƒ API

1. **langchain-core**
   - âœ… `langchain_core.tools.tool` - æ— å˜æ›´
   - âœ… `langchain_core.messages` (HumanMessage, SystemMessage) - æ— å˜æ›´ï¼Œæ–°å¢ž content_blocks å±žæ€§
   - âœ… `langchain_core.output_parsers.JsonOutputParser` - æ— å˜æ›´

2. **langchain-openai**
   - âœ… `ChatOpenAI` - æ— å˜æ›´ï¼ˆæ–°å¢ž content_blocks æ”¯æŒï¼‰
   - âœ… `.ainvoke()` æ–¹æ³• - æ— å˜æ›´

3. **langgraph**
   - âœ… `StateGraph` - æ— å˜æ›´
   - âœ… `END` - æ— å˜æ›´
   - âœ… `TypedDict` çŠ¶æ€å®šä¹‰ - å®Œå…¨ç¬¦åˆ 1.0 è¦æ±‚

### æœªä½¿ç”¨çš„åŠŸèƒ½ï¼ˆä¸ä¼šå—å½±å“ï¼‰

- âŒ `langgraph.prebuilt.create_react_agent` - æœªä½¿ç”¨ï¼ˆ1.0 ä¸­å·²è¿ç§»åˆ° langchain.agentsï¼‰
- âŒ Legacy Chains (LLMChain, ConversationChain) - æœªä½¿ç”¨ï¼ˆ1.0 ä¸­å·²è¿ç§»åˆ° langchain-classicï¼‰
- âŒ `.text()` æ–¹æ³• - æœªä½¿ç”¨ï¼ˆ1.0 ä¸­æ”¹ä¸ºå±žæ€§ `.text`ï¼‰
- âŒ `langchain-community` - å·²å£°æ˜Žä¾èµ–ä½†æœªåœ¨ä»£ç ä¸­ä½¿ç”¨

---

## ðŸš¨ LangChain 1.0 é‡å¤§å˜æ›´æ¦‚è§ˆ

### å®˜æ–¹æ‰¿è¯ºï¼šæ— ç ´åæ€§å˜æ›´

> **é‡è¦ï¼š** LangChain 1.0 è¢«è®¾è®¡ä¸º**æ²¡æœ‰ç ´åæ€§å˜æ›´**ã€‚è¿™æ˜¯é¦–ä¸ªç¨³å®šç‰ˆæœ¬ï¼Œæ‰¿è¯ºåœ¨ 2.0 ä¹‹å‰ä¸ä¼šæœ‰ç ´åæ€§å˜æ›´ã€‚

### ä¸»è¦å˜æ›´

1. **åŒ…ç»“æž„é‡ç»„**
   - æ ¸å¿ƒ `langchain` åŒ…ä¸“æ³¨äºŽ agent æž„å»º
   - ä¼ ç»ŸåŠŸèƒ½ç§»è‡³ `langchain-classic` åŒ…
   - æœ¬é¡¹ç›®ï¼šâœ… ä¸å—å½±å“ï¼ˆæœªä½¿ç”¨ä¼ ç»ŸåŠŸèƒ½ï¼‰

2. **æ–°å¢žåŠŸèƒ½**
   - `content_blocks` å±žæ€§ - æ ‡å‡†åŒ–å†…å®¹å—è®¿é—®
   - `create_agent` API - æ–°çš„ agent æž„å»ºæ–¹å¼
   - ä¸­é—´ä»¶ç³»ç»Ÿ - ç»†ç²’åº¦æŽ§åˆ¶
   - æœ¬é¡¹ç›®ï¼šâœ… æ— éœ€ä¿®æ”¹ï¼ˆæ–°åŠŸèƒ½ä¸ºå¯é€‰ï¼‰

3. **API æ”¹è¿›**
   - `.text()` æ”¹ä¸º `.text` å±žæ€§
   - æœ¬é¡¹ç›®ï¼šâœ… æœªä½¿ç”¨è¯¥æ–¹æ³•

4. **Python ç‰ˆæœ¬è¦æ±‚**
   - è¦æ±‚ Python 3.10+
   - æœ¬é¡¹ç›®ï¼šâœ… å·²é…ç½® `requires-python = ">=3.10"`

---

## âœ… å‡çº§å¯è¡Œæ€§è¯„ä¼°

### é£Žé™©ç­‰çº§ï¼šðŸŸ¢ æžä½Žé£Žé™©

| è¯„ä¼°ç»´åº¦ | è¯„åˆ† | è¯´æ˜Ž |
|---------|------|------|
| **ä»£ç å…¼å®¹æ€§** | â­â­â­â­â­ | 5/5 - æ‰€æœ‰ä½¿ç”¨çš„ API å®Œå…¨å…¼å®¹ |
| **åŠŸèƒ½å®Œæ•´æ€§** | â­â­â­â­â­ | 5/5 - æ— åŠŸèƒ½ç¼ºå¤± |
| **å‡çº§å¤æ‚åº¦** | â­â­â­â­â­ | 5/5 - åªéœ€æ›´æ–°é…ç½®æ–‡ä»¶ |
| **å›žé€€éš¾åº¦** | â­â­â­â­â­ | 5/5 - å¦‚éœ€å›žé€€ï¼Œä¿®æ”¹é…ç½®å³å¯ |
| **ä¾èµ–å†²çªé£Žé™©** | â­â­â­â­â­ | 5/5 - æ‰€æœ‰ç›¸å…³åŒ…å·²æœ‰ 1.0 ç‰ˆæœ¬ |

### ä¼˜åŠ¿

1. âœ… **é¡¹ç›®å·²åœ¨è¿è¡Œ 1.0 ç‰ˆæœ¬** - å®žé™…è¿è¡ŒçŽ¯å¢ƒå·²éªŒè¯ç¨³å®šæ€§
2. âœ… **é›¶ä»£ç ä¿®æ”¹** - æ‰€æœ‰ä»£ç ä¸Ž 1.0 å®Œå…¨å…¼å®¹
3. âœ… **éµå¾ªæœ€ä½³å®žè·µ** - ä½¿ç”¨ TypedDict å®šä¹‰çŠ¶æ€ï¼Œç¬¦åˆ 1.0 æŽ¨èæ–¹å¼
4. âœ… **æœªä½¿ç”¨ä¼ ç»ŸåŠŸèƒ½** - æ— éœ€å®‰è£… langchain-classic
5. âœ… **å®˜æ–¹ç¨³å®šæ€§æ‰¿è¯º** - 1.0 ç‰ˆæœ¬æ‰¿è¯ºæ— ç ´åæ€§å˜æ›´ç›´åˆ° 2.0

### æ³¨æ„äº‹é¡¹

1. âš ï¸ **langchain-community æœªä½¿ç”¨** - è™½åœ¨é…ç½®ä¸­å£°æ˜Žï¼Œä½†ä»£ç æœªä½¿ç”¨ï¼Œå¯è€ƒè™‘ç§»é™¤
2. âš ï¸ **ç‰ˆæœ¬é”å®šå»ºè®®** - å»ºè®®åœ¨ pyproject.toml ä¸­é”å®šä¸»ç‰ˆæœ¬å·ï¼ˆå¦‚ `langchain>=1.0,<2.0`ï¼‰

---

## ðŸ“ æŽ¨èå‡çº§æ–¹æ¡ˆ

### æ–¹æ¡ˆï¼šä»…æ›´æ–°é…ç½®æ–‡ä»¶

ç”±äºŽé¡¹ç›®å®žé™…å·²è¿è¡Œ 1.0 ç‰ˆæœ¬ä¸”è¿è¡Œç¨³å®šï¼Œå»ºè®®é‡‡ç”¨æœ€ç®€å•çš„å‡çº§æ–¹å¼ã€‚

### ä¿®æ”¹æ­¥éª¤

#### 1. æ›´æ–° `pyproject.toml`

å°†ä¾èµ–ç‰ˆæœ¬ä»Ž 0.3 æ›´æ–°åˆ° 1.0ï¼š

```toml
dependencies = [
    # FastAPI æ ¸å¿ƒ
    "fastapi>=0.119.1",
    "uvicorn[standard]>=0.38.0",
    "pydantic[email]>=2.12.3",
    "pydantic-settings>=2.11.0",
    "python-multipart>=0.0.20",

    # LangChain ç”Ÿæ€ - æ›´æ–°ä¸º 1.0
    "langchain>=1.0,<2.0",          # ä»Ž 0.3.27 æ›´æ–°
    "langchain-core>=1.0,<2.0",     # ä»Ž 0.3.0 æ›´æ–°
    "langchain-openai>=1.0,<2.0",   # ä»Ž 0.3.33 æ›´æ–°
    "langchain-anthropic>=1.0,<2.0",# ä»Ž 0.3.20 æ›´æ–°
    "langgraph>=1.0,<2.0",          # ä»Ž 0.6.7 æ›´æ–°

    # å¯é€‰ï¼šå¦‚æžœä¸ä½¿ç”¨å¯ä»¥ç§»é™¤
    # "langchain-community>=0.4.0",  # ä»£ç ä¸­æœªä½¿ç”¨

    # HTTP å®¢æˆ·ç«¯
    "httpx>=0.28.1",

    # é˜¿é‡Œäº‘ OSS
    "oss2>=2.19.0",

    # é‚®ä»¶å‘é€
    "aiosmtplib>=5.0.0",

    # Excel å¤„ç†
    "openpyxl>=3.1.5",
    "pandas>=2.3.3",

    # å·¥å…·åº“
    "python-dotenv>=1.2.1",

    # æ•°æ®åº“
    "mysql-connector-python>=9.5.0",
]
```

#### 2. ï¼ˆå¯é€‰ï¼‰ç§»é™¤æœªä½¿ç”¨çš„ä¾èµ–

å¦‚æžœç¡®è®¤ä¸éœ€è¦ `langchain-community`ï¼Œå¯ä»¥ä»Žé…ç½®ä¸­ç§»é™¤ï¼š

```bash
pip uninstall langchain-community
```

#### 3. éªŒè¯å®‰è£…

```bash
# é‡æ–°å®‰è£…ä¾èµ–ï¼ˆç¡®ä¿ç‰ˆæœ¬ä¸€è‡´ï¼‰
pip install -e .

# éªŒè¯ç‰ˆæœ¬
pip show langchain langchain-core langchain-openai langchain-anthropic langgraph
```

#### 4. è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œé¡¹ç›®æµ‹è¯•å¥—ä»¶
pytest

# æˆ–è¿è¡Œç‰¹å®šæµ‹è¯•
python tests/test_mutation_steps_service.py
```

---

## ðŸ§ª æµ‹è¯•å»ºè®®

### å…³é”®æµ‹è¯•ç‚¹

1. **LLM æœåŠ¡æµ‹è¯•**
   - âœ… ChatOpenAI åˆå§‹åŒ–
   - âœ… æ„å›¾è¯†åˆ«åŠŸèƒ½
   - âœ… å®žä½“æå–åŠŸèƒ½
   - âœ… DML ç”ŸæˆåŠŸèƒ½
   - âœ… æ¶ˆæ¯å¤„ç†ï¼ˆHumanMessage, SystemMessageï¼‰

2. **å·¥å…·æµ‹è¯•**
   - âœ… @tool è£…é¥°å™¨åŠŸèƒ½
   - âœ… SQL æŸ¥è¯¢å·¥å…·æ‰§è¡Œ

3. **å·¥ä½œæµæµ‹è¯•**
   - âœ… StateGraph åˆ›å»ºå’Œç¼–è¯‘
   - âœ… å·¥ä½œæµæ‰§è¡Œ
   - âœ… çŠ¶æ€ä¼ é€’
   - âœ… æ¡ä»¶è·¯ç”±

4. **é›†æˆæµ‹è¯•**
   - âœ… ç«¯åˆ°ç«¯å·¥å•å¤„ç†æµç¨‹
   - âœ… é‚®ä»¶å‘é€åŠŸèƒ½

### æµ‹è¯•è„šæœ¬ç¤ºä¾‹

```bash
# 1. è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest tests/ -v

# 2. è¿è¡Œç‰¹å®šæ¨¡å—æµ‹è¯•
pytest tests/test_llm_service.py -v
pytest tests/test_mutation_steps_service.py -v

# 3. è¿è¡Œé›†æˆæµ‹è¯•
pytest tests/integration/ -v
```

---

## ðŸ“ˆ å‡çº§åŽçš„ä¼˜åŠ¿

### åŠŸèƒ½ä¼˜åŠ¿

1. **ç¨³å®šæ€§ä¿è¯**
   - å®˜æ–¹æ‰¿è¯ºæ— ç ´åæ€§å˜æ›´ç›´åˆ° 2.0
   - æ›´å¥½çš„é•¿æœŸç»´æŠ¤æ”¯æŒ

2. **æ–°åŠŸèƒ½è®¿é—®**
   - `content_blocks` - ç»Ÿä¸€è®¿é—® LLM å†…å®¹
   - æ”¹è¿›çš„ç»“æž„åŒ–è¾“å‡º
   - æ–°çš„ä¸­é—´ä»¶ç³»ç»Ÿï¼ˆå¯é€‰ä½¿ç”¨ï¼‰

3. **æ€§èƒ½ä¼˜åŒ–**
   - åŒ…ä½“ç§¯æ›´å°ï¼ˆæ ¸å¿ƒåŒ…æ›´ç²¾ç®€ï¼‰
   - æ”¹è¿›çš„ä¾èµ–ç®¡ç†

4. **æœªæ¥å…¼å®¹æ€§**
   - ä¸ºæœªæ¥çš„åŠŸèƒ½å‡çº§åšå¥½å‡†å¤‡
   - ä¸Žæœ€æ–°çš„ LangGraph 1.0 å®Œå…¨é›†æˆ

### å¼€å‘ä½“éªŒæ”¹è¿›

1. **æ›´æ¸…æ™°çš„åŒ…ç»“æž„**
   - æ ¸å¿ƒåŠŸèƒ½æ›´èšç„¦
   - æ–‡æ¡£æ›´å®Œå–„

2. **æ›´å¥½çš„ç±»åž‹æ”¯æŒ**
   - æ”¹è¿›çš„ç±»åž‹æç¤º
   - æ›´å¥½çš„ IDE æ”¯æŒ

---

## ðŸ”„ å›žé€€æ–¹æ¡ˆ

å¦‚æžœå‡çº§åŽé‡åˆ°ä»»ä½•é—®é¢˜ï¼Œå¯ä»¥è½»æ¾å›žé€€ï¼š

### å›žé€€æ­¥éª¤

1. ä¿®æ”¹ `pyproject.toml`ï¼Œå°†ç‰ˆæœ¬æ”¹å›ž 0.3ï¼š

```toml
"langchain>=0.3.27,<0.4",
"langchain-core>=0.3.0,<0.4",
"langchain-community>=0.3.0,<0.4",
"langchain-openai>=0.3.33,<0.4",
"langchain-anthropic>=0.3.20,<0.4",
"langgraph>=0.6.7,<0.7",
```

2. é‡æ–°å®‰è£…ä¾èµ–ï¼š

```bash
pip install -e . --force-reinstall
```

3. éªŒè¯ç‰ˆæœ¬ï¼š

```bash
pip show langchain
```

---

## ðŸ“Š æ—¶é—´å’Œèµ„æºè¯„ä¼°

| ä»»åŠ¡ | é¢„è®¡æ—¶é—´ | é£Žé™© |
|------|---------|------|
| æ›´æ–°é…ç½®æ–‡ä»¶ | 5 åˆ†é’Ÿ | ðŸŸ¢ æžä½Ž |
| é‡æ–°å®‰è£…ä¾èµ– | 2-5 åˆ†é’Ÿ | ðŸŸ¢ æžä½Ž |
| è¿è¡Œæµ‹è¯•å¥—ä»¶ | 5-10 åˆ†é’Ÿ | ðŸŸ¢ æžä½Ž |
| éªŒè¯åŠŸèƒ½ | 15-30 åˆ†é’Ÿ | ðŸŸ¢ æžä½Ž |
| **æ€»è®¡** | **30-50 åˆ†é’Ÿ** | **ðŸŸ¢ æžä½Ž** |

---

## ðŸŽ¯ æœ€ç»ˆå»ºè®®

### âœ… å¼ºçƒˆæŽ¨èå‡çº§

ç†ç”±ï¼š
1. **å®žé™…å·²åœ¨ä½¿ç”¨ 1.0** - é¡¹ç›®è¿è¡ŒçŽ¯å¢ƒå·²ç»æ˜¯ 1.0ï¼Œåªéœ€åŒæ­¥é…ç½®
2. **é›¶ä»£ç ä¿®æ”¹** - æ— éœ€ä»»ä½•ä»£ç æ”¹åŠ¨
3. **å®˜æ–¹ç¨³å®šç‰ˆ** - 1.0 æ˜¯é¦–ä¸ªç¨³å®šç‰ˆæœ¬ï¼Œæœ‰å®˜æ–¹é•¿æœŸæ”¯æŒæ‰¿è¯º
4. **æžä½Žé£Žé™©** - æ‰€æœ‰ä½¿ç”¨çš„ API å®Œå…¨å…¼å®¹
5. **æ˜“äºŽå›žé€€** - å¦‚æœ‰é—®é¢˜å¯å¿«é€Ÿå›žé€€

### ç«‹å³è¡ŒåŠ¨è®¡åˆ’

1. âœ… **ä»Šå¤©ï¼š** æ›´æ–° `pyproject.toml` é…ç½®æ–‡ä»¶
2. âœ… **ä»Šå¤©ï¼š** è¿è¡Œæµ‹è¯•å¥—ä»¶éªŒè¯åŠŸèƒ½
3. âœ… **ä»Šå¤©ï¼š** æäº¤é…ç½®æ›´æ–°
4. âœ… **æœ¬å‘¨ï¼š** åœ¨ç”Ÿäº§çŽ¯å¢ƒè§‚å¯Ÿè¿è¡Œæƒ…å†µï¼ˆå¦‚æžœå½“å‰ä¸æ˜¯ç”Ÿäº§çŽ¯å¢ƒï¼‰

---

## ðŸ“š å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£

- [LangChain v1 è¿ç§»æŒ‡å—](https://docs.langchain.com/oss/python/migrate/langchain-v1)
- [LangChain v1 æ–°ç‰¹æ€§](https://docs.langchain.com/oss/python/releases/langchain-v1)
- [LangChain 1.0 å‘å¸ƒå…¬å‘Š](https://blog.langchain.com/langchain-langgraph-1dot0/)
- [LangChain å‘å¸ƒæ”¿ç­–](https://python.langchain.com/docs/versions/release_policy/)

### ç‰ˆæœ¬ä¿¡æ¯

- [langchain-core PyPI](https://pypi.org/project/langchain-core/)
- [langchain-openai PyPI](https://pypi.org/project/langchain-openai/)
- [langgraph PyPI](https://pypi.org/project/langgraph/)

---

## ðŸ“ž æ”¯æŒ

å¦‚åœ¨å‡çº§è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯å‚è€ƒï¼š

- LangChain å®˜æ–¹è®ºå›: https://forum.langchain.com/
- GitHub Issues: https://github.com/langchain-ai/langchain/issues
- å®˜æ–¹å˜æ›´æ—¥å¿—: https://changelog.langchain.com/

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´ï¼š** 2025-11-08
**åˆ†æžç‰ˆæœ¬ï¼š** LangChain 0.3.x â†’ 1.0.x
**é¡¹ç›®çŠ¶æ€ï¼š** ç”Ÿäº§å°±ç»ªï¼Œå»ºè®®å‡çº§
